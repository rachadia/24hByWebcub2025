import{a as Q}from"./chunk-DBWOAHIO.js";import{a as G}from"./chunk-LBTGIF5T.js";import{b as R,d as W,e as H,f as z,g as P,h as Y,p as q}from"./chunk-GIPP6JLH.js";import{a as J,b as K}from"./chunk-CNVZTMWS.js";import"./chunk-IDITQWI3.js";import{$ as i,Ba as L,Ca as V,Da as U,E as p,Ea as F,F as g,Fa as M,La as N,M as _,N as a,Na as A,Oa as B,P as x,Q as C,Ra as O,V as v,Y as s,_ as n,aa as h,ba as y,ca as u,da as l,fa as m,ga as c,ha as b,ia as S,ja as w,ka as I,la as D,oa as T,ra as j,sa as E,ua as k}from"./chunk-7B2THDHR.js";var $=t=>["/events",t,"edit"],ee=(t,d,e,r)=>({"text-joy-600 dark:text-joy-400":t,"text-sadness-600 dark:text-sadness-400":d,"text-anger-600 dark:text-anger-400":e,"text-fear-600 dark:text-fear-400":r});function te(t,d){if(t&1&&(n(0,"a",10),m(1," Edit Event "),i()),t&2){let e=l();s("routerLink",T(1,$,e.event==null?null:e.event.id))}}function ne(t,d){if(t&1){let e=y();n(0,"button",11),u("click",function(){p(e);let o=l();return g(o.deleteEvent())}),m(1," Delete "),i()}}function ie(t,d){t&1&&(n(0,"div",12),h(1,"div",13),i())}function re(t,d){if(t&1&&(n(0,"div",37),h(1,"img",38),i()),t&2){let e=d.$implicit;a(),s("src",e,_)}}function oe(t,d){if(t&1&&(n(0,"div",33)(1,"h3",34),m(2,"Attachments"),i(),n(3,"div",35),v(4,re,2,1,"div",36),i()()),t&2){let e=l(2);a(4),s("ngForOf",e.event.attachments)}}function ae(t,d){if(t&1&&h(0,"img",48),t&2){let e=l(3);s("src",e.currentUser.profileImage,_)}}function me(t,d){if(t&1&&(n(0,"span"),m(1),i()),t&2){let e=l(3);a(),c(e.currentUser.username.charAt(0))}}function se(t,d){if(t&1){let e=y();n(0,"div",39)(1,"div",4)(2,"div",40),v(3,ae,1,1,"img",41)(4,me,2,1,"span",42),i(),n(5,"div",43)(6,"form",44),u("ngSubmit",function(){p(e);let o=l(2);return g(o.addComment())}),n(7,"textarea",45),D("ngModelChange",function(o){p(e);let f=l(2);return I(f.newComment,o)||(f.newComment=o),g(o)}),i(),n(8,"div",46)(9,"button",47),m(10," Comment "),i()()()()()()}if(t&2){let e=l(2);a(3),s("ngIf",e.currentUser.profileImage),a(),s("ngIf",!e.currentUser.profileImage),a(3),w("ngModel",e.newComment),a(2),s("disabled",!e.newComment.trim())}}function de(t,d){if(t&1&&(n(0,"div",4)(1,"div",40)(2,"span"),m(3),i()(),n(4,"div",49)(5,"div",50)(6,"h3",51),m(7),i(),n(8,"p",52),m(9),E(10,"date"),i()(),n(11,"p",53),m(12),i()()()),t&2){let e=d.$implicit;a(3),c(e.username.charAt(0)),a(4),c(e.username),a(2),c(k(10,4,e.createdAt,"medium")),a(3),c(e.content)}}function le(t,d){t&1&&(n(0,"div",54)(1,"p",55),m(2,"No comments yet. Be the first to comment!"),i()())}function ce(t,d){if(t&1){let e=y();n(0,"div",14)(1,"div",15)(2,"div",16)(3,"div")(4,"h1",17),m(5),i(),n(6,"div",18)(7,"span"),m(8),E(9,"date"),i(),n(10,"span",19),m(11,"\u2022"),i(),n(12,"span",14),m(13),i()()()(),n(14,"div",20)(15,"p",21),m(16),i()(),v(17,oe,5,1,"div",22),i(),n(18,"div",15)(19,"div",23)(20,"div",24)(21,"button",25),u("click",function(){p(e);let o=l();return g(o.likeEvent())}),n(22,"span"),m(23,"\u2764\uFE0F"),i(),n(24,"span"),m(25),i()(),n(26,"button",25),u("click",function(){p(e);let o=l();return g(o.scrollToComments())}),n(27,"span"),m(28,"\u{1F4AC}"),i(),n(29,"span"),m(30),i()()(),n(31,"button",26),u("click",function(){p(e);let o=l();return g(o.shareEvent())}),n(32,"span"),m(33,"\u{1F517} Share"),i()()()(),n(34,"div",27)(35,"h2",28),m(36,"Comments"),i(),v(37,se,11,4,"div",29),n(38,"div",30),v(39,de,13,7,"div",31)(40,le,3,0,"div",32),i()()()}if(t&2){let e=l();s("ngClass",e.event.theme),a(5),c(e.event.title),a(3),c(k(9,13,e.event.createdAt,"medium")),a(4),s("ngClass",j(16,ee,e.event.emotion==="joy",e.event.emotion==="sadness",e.event.emotion==="anger",e.event.emotion==="fear")),a(),S(" ",e.getEmotionIcon(e.event.emotion)," ",e.getEmotionDisplayName(e.event.emotion)," "),a(3),c(e.event.content),a(),s("ngIf",e.event.attachments&&e.event.attachments.length>0),a(8),b("",e.event.likes," Likes"),a(5),b("",e.event.comments.length," Comments"),a(7),s("ngIf",e.currentUser),a(2),s("ngForOf",e.event.comments),a(),s("ngIf",e.event.comments.length===0)}}function ve(t,d){t&1&&(n(0,"div",56)(1,"div",57),m(2,"\u{1F615}"),i(),n(3,"h3",58),m(4,"Event not found"),i(),n(5,"p",59),m(6," The event you're looking for doesn't exist or has been removed. "),i(),n(7,"a",60),m(8," Back to Events "),i()())}var Ce=(()=>{class t{constructor(e,r,o,f,X,Z){this.route=e,this.router=r,this.eventService=o,this.authService=f,this.emotionService=X,this.themeService=Z,this.isLoading=!0,this.currentUser=null,this.newComment=""}ngOnInit(){this.currentUser=this.authService.getCurrentUser();let e=this.route.snapshot.paramMap.get("id");e&&this.loadEvent(e)}loadEvent(e){this.eventService.getEventById(e).subscribe({next:r=>{switch(this.event=r,this.isLoading=!1,console.log(this.event),this.event?.emotion){case"joy":this.themeService.setTheme("joy");break;case"sadness":this.themeService.setTheme("sadness");break}},error:r=>{console.error("Error loading event:",r),this.isLoading=!1}})}likeEvent(){this.event&&this.eventService.toggleLike(this.event.id).subscribe({next:e=>{this.event=e},error:e=>{console.error("Error liking event:",e)}})}addComment(){!this.event||!this.currentUser||!this.newComment.trim()||this.eventService.addComment(this.event.id,this.currentUser.id,this.currentUser.username,this.newComment.trim()).subscribe({next:e=>{this.event=e,this.newComment="",this.eventService.getEventById(this.event.id).subscribe({next:r=>{this.event=r},error:r=>{console.error("Error refreshing event:",r)}})},error:e=>{console.error("Error adding comment:",e)}})}deleteEvent(){this.event&&confirm("Are you sure you want to delete this event? This action cannot be undone.")&&this.eventService.deleteEvent(this.event.id).subscribe({next:()=>{this.router.navigate(["/events"])},error:e=>{console.error("Error deleting event:",e)}})}scrollToComments(){document.getElementById("comments")?.scrollIntoView({behavior:"smooth"})}getEmotionDisplayName(e){return this.emotionService.getEmotionDisplayName(e)}getEmotionIcon(e){return this.emotionService.getEmotionIcon(e)}shareEvent(){let e=window.location.href;navigator.share?navigator.share({title:this.event?.title||"Event",text:this.event?.content||"Check out this event!",url:e}).catch(r=>{console.error("Error sharing:",r),this.copyToClipboard(e)}):this.copyToClipboard(e)}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{let r=document.querySelector('button:has(span:contains("\u{1F517} Share"))');if(r){let o=r.innerHTML;r.innerHTML="<span>\u2713 Copied!</span>",setTimeout(()=>{r.innerHTML=o},2e3)}}).catch(r=>{console.error("Failed to copy text: ",r)})}static{this.\u0275fac=function(r){return new(r||t)(x(N),x(A),x(K),x(G),x(J),x(Q))}}static{this.\u0275cmp=C({type:t,selectors:[["app-event-detail"]],decls:12,vars:5,consts:[[1,"mx-auto","max-w-4xl"],[1,"mb-6","flex","items-center","justify-between"],["routerLink","/events",1,"flex","items-center","text-sm","font-medium","text-gray-600","hover:text-gray-900","dark:text-gray-400","dark:hover:text-gray-200"],[1,"mr-1"],[1,"flex","space-x-3"],["class","rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",3,"routerLink",4,"ngIf"],["class","rounded-md bg-red-100 px-3 py-2 text-sm font-medium text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-200 dark:hover:bg-red-900/30",3,"click",4,"ngIf"],["class","flex justify-center py-12",4,"ngIf"],[3,"ngClass",4,"ngIf"],["class","rounded-lg bg-white p-8 text-center shadow-elevation-1 dark:bg-gray-800",4,"ngIf"],[1,"rounded-md","bg-gray-100","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-200","dark:bg-gray-700","dark:text-gray-200","dark:hover:bg-gray-600",3,"routerLink"],[1,"rounded-md","bg-red-100","px-3","py-2","text-sm","font-medium","text-red-700","hover:bg-red-200","dark:bg-red-900/20","dark:text-red-200","dark:hover:bg-red-900/30",3,"click"],[1,"flex","justify-center","py-12"],[1,"h-8","w-8","animate-spin","rounded-full","border-4","border-primary-500","border-t-transparent"],[3,"ngClass"],[1,"mb-6","rounded-lg","bg-white","p-6","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900","dark:text-white"],[1,"mt-2","flex","items-center","text-sm","text-gray-500","dark:text-gray-400"],[1,"mx-2"],[1,"prose","prose-lg","max-w-none","dark:prose-invert"],[1,"whitespace-pre-wrap","text-gray-700","dark:text-gray-300"],["class","mt-6",4,"ngIf"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-1","rounded-md","px-3","py-1","text-sm","text-gray-700","hover:bg-gray-100","dark:text-gray-300","dark:hover:bg-gray-700",3,"click"],[1,"rounded-md","px-3","py-1","text-sm","text-gray-700","hover:bg-gray-100","dark:text-gray-300","dark:hover:bg-gray-700",3,"click"],["id","comments",1,"rounded-lg","bg-white","p-6","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","text-xl","font-semibold","text-gray-900","dark:text-white"],["class","mb-6",4,"ngIf"],[1,"space-y-4"],["class","flex space-x-3",4,"ngFor","ngForOf"],["class","py-4 text-center",4,"ngIf"],[1,"mt-6"],[1,"mb-3","text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-3"],["class","overflow-hidden rounded-lg",4,"ngFor","ngForOf"],[1,"overflow-hidden","rounded-lg"],["alt","Attachment",1,"h-48","w-full","object-cover","transition","duration-300","hover:scale-105",3,"src"],[1,"mb-6"],[1,"avatar"],["alt","Your profile image","class","h-full w-full object-cover",3,"src",4,"ngIf"],[4,"ngIf"],[1,"flex-1"],[3,"ngSubmit"],["name","comment","rows","3","placeholder","Write a comment...",1,"textarea",3,"ngModelChange","ngModel"],[1,"mt-2","flex","justify-end"],["type","submit",1,"rounded-md","bg-primary-600","px-3","py-1.5","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","disabled:opacity-50","dark:bg-primary-700","dark:hover:bg-primary-600",3,"disabled"],["alt","Your profile image",1,"h-full","w-full","object-cover",3,"src"],[1,"flex-1","rounded-lg","bg-gray-50","p-4","dark:bg-gray-700"],[1,"mb-1","flex","items-center","justify-between"],[1,"text-sm","font-semibold","text-gray-900","dark:text-white"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"py-4","text-center"],[1,"text-gray-500","dark:text-gray-400"],[1,"rounded-lg","bg-white","p-8","text-center","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","text-4xl"],[1,"mb-2","text-xl","font-semibold","text-gray-900","dark:text-white"],[1,"mb-6","text-gray-600","dark:text-gray-400"],["routerLink","/events",1,"inline-block","rounded-md","bg-primary-600","px-4","py-2","text-white","hover:bg-primary-700","dark:bg-primary-700","dark:hover:bg-primary-600"]],template:function(r,o){r&1&&(n(0,"div",0)(1,"div",1)(2,"a",2)(3,"span",3),m(4,"\u2190"),i(),m(5," Back to Events "),i(),n(6,"div",4),v(7,te,2,3,"a",5)(8,ne,2,0,"button",6),i()(),v(9,ie,2,0,"div",7)(10,ce,41,21,"div",8)(11,ve,9,0,"div",9),i()),r&2&&(a(7),s("ngIf",o.currentUser&&(o.event==null?null:o.event.userId)===o.currentUser.id),a(),s("ngIf",o.currentUser&&(o.event==null?null:o.event.userId)===o.currentUser.id),a(),s("ngIf",o.isLoading),a(),s("ngIf",!o.isLoading&&o.event),a(),s("ngIf",!o.isLoading&&!o.event))},dependencies:[M,L,V,U,F,O,B,q,Y,R,W,H,P,z],encapsulation:2})}}return t})();export{Ce as EventDetailComponent};
