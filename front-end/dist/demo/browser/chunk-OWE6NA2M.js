import{b as M,c as h,d as V,e as B,h as q,i as G,j as R,o as A,p as z,q as Y}from"./chunk-6QK7JL3M.js";import{a as H,b as O}from"./chunk-EP3PJAGG.js";import"./chunk-WPHHPEL3.js";import{F as _,G as E,Ga as k,H as b,Ia as F,La as D,O as l,Q as u,R as S,Ra as N,Ta as T,Ua as L,W as c,Xa as j,Z as d,aa as r,ba as n,ca as g,ga as C,ha as I,ia as p,ka as m,la as w,ma as y,ta as f}from"./chunk-Y4TBAV6C.js";var J=e=>["/events",e],U=e=>({"border-red-500 dark:border-red-400":e});function K(e,s){e&1&&(r(0,"div",7),g(1,"div",8),n())}function P(e,s){e&1&&(r(0,"div"),m(1,"Title is required"),n())}function Q(e,s){if(e&1&&(r(0,"div",22),c(1,P,2,0,"div",23),n()),e&2){let t,i=p(2);l(),d("ngIf",(t=i.eventForm.get("title"))==null||t.errors==null?null:t.errors.required)}}function W(e,s){e&1&&(r(0,"div"),m(1,"Content is required"),n())}function X(e,s){e&1&&(r(0,"div"),m(1," Content must be at least 10 characters "),n())}function Z(e,s){if(e&1&&(r(0,"div",22),c(1,W,2,0,"div",23)(2,X,2,0,"div",23),n()),e&2){let t,i,o=p(2);l(),d("ngIf",(t=o.eventForm.get("content"))==null||t.errors==null?null:t.errors.required),l(),d("ngIf",(i=o.eventForm.get("content"))==null||i.errors==null?null:i.errors.minlength)}}function $(e,s){if(e&1&&(r(0,"div",11)(1,"div",24)(2,"div",25)(3,"div",26)(4,"span",27),m(5),n()(),r(6,"div",28)(7,"h3",29),m(8),n(),r(9,"div",30)(10,"p"),m(11),n()()()()()()),e&2){let t=p(2);l(5),w(t.emotionIcon),l(3),y(" Detected Mood: ",t.emotionDisplayName," "),l(3),y(" Based on your text, we've detected a ",t.emotionDisplayName.toLowerCase()," mood. Your event will be styled with a matching theme. ")}}function ee(e,s){e&1&&(r(0,"span",31),b(),r(1,"svg",32),g(2,"circle",33)(3,"path",34),n()())}function te(e,s){if(e&1){let t=C();r(0,"div",9)(1,"form",10),I("ngSubmit",function(){_(t);let o=p();return E(o.onSubmit())}),r(2,"div",11)(3,"label",12),m(4,"Title"),n(),g(5,"input",13),c(6,Q,2,1,"div",14),n(),r(7,"div",11)(8,"label",15),m(9,"Your Event"),n(),g(10,"textarea",16),c(11,Z,3,2,"div",14),n(),c(12,$,12,3,"div",17),r(13,"div",18)(14,"a",19),m(15," Cancel "),n(),r(16,"button",20),c(17,ee,4,0,"span",21),m(18," Update Event "),n()()()()}if(e&2){let t,i,o,v,a=p();l(),d("formGroup",a.eventForm),l(4),d("ngClass",f(9,U,((t=a.eventForm.get("title"))==null?null:t.invalid)&&(((t=a.eventForm.get("title"))==null?null:t.dirty)||((t=a.eventForm.get("title"))==null?null:t.touched)))),l(),d("ngIf",((i=a.eventForm.get("title"))==null?null:i.invalid)&&(((i=a.eventForm.get("title"))==null?null:i.dirty)||((i=a.eventForm.get("title"))==null?null:i.touched))),l(4),d("ngClass",f(11,U,((o=a.eventForm.get("content"))==null?null:o.invalid)&&(((o=a.eventForm.get("content"))==null?null:o.dirty)||((o=a.eventForm.get("content"))==null?null:o.touched)))),l(),d("ngIf",((v=a.eventForm.get("content"))==null?null:v.invalid)&&(((v=a.eventForm.get("content"))==null?null:v.dirty)||((v=a.eventForm.get("content"))==null?null:v.touched))),l(),d("ngIf",a.detectedEmotion),l(2),d("routerLink",f(13,J,a.eventId)),l(2),d("disabled",a.eventForm.invalid||a.isSubmitting),l(),d("ngIf",a.isSubmitting)}}function ie(e,s){e&1&&(r(0,"div",35)(1,"div",36),m(2,"\u{1F615}"),n(),r(3,"h3",37),m(4,"Event not found"),n(),r(5,"p",38),m(6," The event you're looking for doesn't exist or has been removed. "),n(),r(7,"a",39),m(8," Back to Events "),n()())}var ce=(()=>{class e{constructor(t,i,o,v,a){this.route=t,this.router=i,this.formBuilder=o,this.eventService=v,this.emotionService=a,this.isLoading=!0,this.isSubmitting=!1,this.detectedEmotion="",this.emotionDisplayName="",this.emotionIcon="",this.eventId=this.route.snapshot.paramMap.get("id")||"",this.eventForm=this.formBuilder.group({title:["",h.required],content:["",[h.required,h.minLength(10)]],attachments:[[]]}),this.eventForm.get("content")?.valueChanges.subscribe(x=>{x&&x.length>20?(this.detectedEmotion=this.emotionService.detectEmotion(x),this.emotionDisplayName=this.emotionService.getEmotionDisplayName(this.detectedEmotion),this.emotionIcon=this.emotionService.getEmotionIcon(this.detectedEmotion)):this.detectedEmotion=""})}ngOnInit(){this.eventId&&this.loadEvent(this.eventId)}loadEvent(t){this.eventService.getEventById(t).subscribe({next:i=>{this.event=i,i&&(this.eventForm.patchValue({title:i.title,content:i.content}),this.detectedEmotion=i.emotion,this.emotionDisplayName=this.emotionService.getEmotionDisplayName(this.detectedEmotion),this.emotionIcon=this.emotionService.getEmotionIcon(this.detectedEmotion)),this.isLoading=!1},error:i=>{console.error("Error loading event:",i),this.isLoading=!1}})}onSubmit(){this.eventForm.invalid||!this.event||(this.isSubmitting=!0,this.eventService.updateEvent(this.event.id,this.eventForm.value).subscribe({next:t=>{this.router.navigate(["/events",t.id])},error:t=>{console.error("Error updating event:",t),this.isSubmitting=!1}}))}static{this.\u0275fac=function(i){return new(i||e)(u(N),u(T),u(A),u(O),u(H))}}static{this.\u0275cmp=S({type:e,selectors:[["app-event-edit"]],decls:9,vars:6,consts:[[1,"mx-auto","max-w-4xl"],[1,"mb-8","flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900","dark:text-white"],[1,"rounded-md","bg-gray-100","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-200","dark:bg-gray-700","dark:text-gray-200","dark:hover:bg-gray-600",3,"routerLink"],["class","flex justify-center py-12",4,"ngIf"],["class","rounded-lg bg-white p-6 shadow-elevation-1 dark:bg-gray-800",4,"ngIf"],["class","rounded-lg bg-white p-8 text-center shadow-elevation-1 dark:bg-gray-800",4,"ngIf"],[1,"flex","justify-center","py-12"],[1,"h-8","w-8","animate-spin","rounded-full","border-4","border-primary-500","border-t-transparent"],[1,"rounded-lg","bg-white","p-6","shadow-elevation-1","dark:bg-gray-800"],[3,"ngSubmit","formGroup"],[1,"mb-6"],["for","title",1,"label"],["type","text","id","title","formControlName","title","placeholder","Give your event a title",1,"input",3,"ngClass"],["class","mt-1 text-sm text-red-600 dark:text-red-400",4,"ngIf"],["for","content",1,"label"],["id","content","formControlName","content","rows","6","placeholder","Describe what happened and how you feel about it...",1,"textarea",3,"ngClass"],["class","mb-6",4,"ngIf"],[1,"flex","justify-end"],[1,"mr-3","rounded-md","bg-white","px-4","py-2","text-sm","font-medium","text-gray-700","shadow-sm","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","dark:bg-gray-700","dark:text-gray-200","dark:hover:bg-gray-600",3,"routerLink"],["type","submit",1,"inline-flex","items-center","rounded-md","border","border-transparent","bg-primary-600","px-4","py-2","text-sm","font-medium","text-white","shadow-sm","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","disabled:opacity-70","dark:bg-primary-700","dark:hover:bg-primary-600",3,"disabled"],["class","mr-2",4,"ngIf"],[1,"mt-1","text-sm","text-red-600","dark:text-red-400"],[4,"ngIf"],[1,"rounded-md","bg-gray-50","p-4","dark:bg-gray-700"],[1,"flex"],[1,"flex-shrink-0"],[1,"text-2xl"],[1,"ml-3"],[1,"text-sm","font-medium","text-gray-800","dark:text-gray-200"],[1,"mt-2","text-sm","text-gray-600","dark:text-gray-300"],[1,"mr-2"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none",1,"h-4","w-4","animate-spin","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"rounded-lg","bg-white","p-8","text-center","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","text-4xl"],[1,"mb-2","text-xl","font-semibold","text-gray-900","dark:text-white"],[1,"mb-6","text-gray-600","dark:text-gray-400"],["routerLink","/events",1,"inline-block","rounded-md","bg-primary-600","px-4","py-2","text-white","hover:bg-primary-700","dark:bg-primary-700","dark:hover:bg-primary-600"]],template:function(i,o){i&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"Edit Event"),n(),r(4,"a",3),m(5," Cancel "),n()(),c(6,K,2,0,"div",4)(7,te,19,15,"div",5)(8,ie,9,0,"div",6),n()),i&2&&(l(4),d("routerLink",f(4,J,o.eventId)),l(2),d("ngIf",o.isLoading),l(),d("ngIf",!o.isLoading&&o.event),l(),d("ngIf",!o.isLoading&&!o.event))},dependencies:[D,k,F,j,L,z,q,M,V,B,Y,G,R],encapsulation:2})}}return e})();export{ce as EventEditComponent};
