import{a as Z}from"./chunk-DBWOAHIO.js";import{a as J}from"./chunk-FPV3HB4M.js";import{b as Y,d as G,e as q,f as P,g as W,h as z,p as K}from"./chunk-GIPP6JLH.js";import{a as Q,b as X}from"./chunk-ER2TAIA3.js";import"./chunk-WPHHPEL3.js";import{$ as i,Ba as A,Ca as M,Da as U,E as p,Ea as V,F as g,Fa as F,La as O,M as E,N as a,Na as H,Oa as B,P as u,Q as w,Ra as R,V as v,Y as m,_ as n,aa as f,ba as y,ca as x,da as l,fa as s,ga as c,ha as k,ia as I,ja as T,ka as D,la as L,oa as N,ra as j,sa as S,ua as C}from"./chunk-7B2THDHR.js";function _(t){let d=window.globalThemeManager;if(!d){console.error("Le gestionnaire de th\xE8mes n'est pas disponible. Assurez-vous que l'application est correctement initialis\xE9e.");return}d.applyTheme(t)}var b={JOY:"theme-joy",SADNESS:"theme-sadness",ANGER:"theme-anger",NEUTRAL:"theme-neutre",INTENSITY:"theme-intensity",DARK_PASSION:"dark-passion",LIGHT_MELANCHOLY:"light-melancholy",LIGHT_NEUTRAL:"light-neutral"};var te=t=>["/events",t,"edit"],ne=(t,d,e,r)=>({"text-joy-600 dark:text-joy-400":t,"text-sadness-600 dark:text-sadness-400":d,"text-anger-600 dark:text-anger-400":e,"text-fear-600 dark:text-fear-400":r});function ie(t,d){if(t&1&&(n(0,"a",10),s(1," Edit Event "),i()),t&2){let e=l();m("routerLink",N(1,te,e.event==null?null:e.event.id))}}function re(t,d){if(t&1){let e=y();n(0,"button",11),x("click",function(){p(e);let o=l();return g(o.deleteEvent())}),s(1," Delete "),i()}}function oe(t,d){t&1&&(n(0,"div",12),f(1,"div",13),i())}function ae(t,d){if(t&1&&(n(0,"div",37),f(1,"img",38),i()),t&2){let e=d.$implicit;a(),m("src",e,E)}}function se(t,d){if(t&1&&(n(0,"div",33)(1,"h3",34),s(2,"Attachments"),i(),n(3,"div",35),v(4,ae,2,1,"div",36),i()()),t&2){let e=l(2);a(4),m("ngForOf",e.event.attachments)}}function me(t,d){if(t&1&&f(0,"img",48),t&2){let e=l(3);m("src",e.currentUser.profileImage,E)}}function de(t,d){if(t&1&&(n(0,"span"),s(1),i()),t&2){let e=l(3);a(),c(e.currentUser.username.charAt(0))}}function le(t,d){if(t&1){let e=y();n(0,"div",39)(1,"div",4)(2,"div",40),v(3,me,1,1,"img",41)(4,de,2,1,"span",42),i(),n(5,"div",43)(6,"form",44),x("ngSubmit",function(){p(e);let o=l(2);return g(o.addComment())}),n(7,"textarea",45),L("ngModelChange",function(o){p(e);let h=l(2);return D(h.newComment,o)||(h.newComment=o),g(o)}),i(),n(8,"div",46)(9,"button",47),s(10," Comment "),i()()()()()()}if(t&2){let e=l(2);a(3),m("ngIf",e.currentUser.profileImage),a(),m("ngIf",!e.currentUser.profileImage),a(3),T("ngModel",e.newComment),a(2),m("disabled",!e.newComment.trim())}}function ce(t,d){if(t&1&&(n(0,"div",4)(1,"div",40)(2,"span"),s(3),i()(),n(4,"div",49)(5,"div",50)(6,"h3",51),s(7),i(),n(8,"p",52),s(9),S(10,"date"),i()(),n(11,"p",53),s(12),i()()()),t&2){let e=d.$implicit;a(3),c(e.username.charAt(0)),a(4),c(e.username),a(2),c(C(10,4,e.createdAt,"medium")),a(3),c(e.content)}}function ve(t,d){t&1&&(n(0,"div",54)(1,"p",55),s(2,"No comments yet. Be the first to comment!"),i()())}function pe(t,d){if(t&1){let e=y();n(0,"div",14)(1,"div",15)(2,"div",16)(3,"div")(4,"h1",17),s(5),i(),n(6,"div",18)(7,"span"),s(8),S(9,"date"),i(),n(10,"span",19),s(11,"\u2022"),i(),n(12,"span",14),s(13),i()()()(),n(14,"div",20)(15,"p",21),s(16),i()(),v(17,se,5,1,"div",22),i(),n(18,"div",15)(19,"div",23)(20,"div",24)(21,"button",25),x("click",function(){p(e);let o=l();return g(o.likeEvent())}),n(22,"span"),s(23,"\u2764\uFE0F"),i(),n(24,"span"),s(25),i()(),n(26,"button",25),x("click",function(){p(e);let o=l();return g(o.scrollToComments())}),n(27,"span"),s(28,"\u{1F4AC}"),i(),n(29,"span"),s(30),i()()(),n(31,"button",26),x("click",function(){p(e);let o=l();return g(o.shareEvent())}),n(32,"span"),s(33,"\u{1F517} Share"),i()()()(),n(34,"div",27)(35,"h2",28),s(36,"Comments"),i(),v(37,le,11,4,"div",29),n(38,"div",30),v(39,ce,13,7,"div",31)(40,ve,3,0,"div",32),i()()()}if(t&2){let e=l();m("ngClass",e.event.theme),a(5),c(e.event.title),a(3),c(C(9,13,e.event.createdAt,"medium")),a(4),m("ngClass",j(16,ne,e.event.emotion==="joy",e.event.emotion==="sadness",e.event.emotion==="anger",e.event.emotion==="fear")),a(),I(" ",e.getEmotionIcon(e.event.emotion)," ",e.getEmotionDisplayName(e.event.emotion)," "),a(3),c(e.event.content),a(),m("ngIf",e.event.attachments&&e.event.attachments.length>0),a(8),k("",e.event.likes," Likes"),a(5),k("",e.event.comments.length," Comments"),a(7),m("ngIf",e.currentUser),a(2),m("ngForOf",e.event.comments),a(),m("ngIf",e.event.comments.length===0)}}function ge(t,d){t&1&&(n(0,"div",56)(1,"div",57),s(2,"\u{1F615}"),i(),n(3,"h3",58),s(4,"Event not found"),i(),n(5,"p",59),s(6," The event you're looking for doesn't exist or has been removed. "),i(),n(7,"a",60),s(8," Back to Events "),i()())}var De=(()=>{class t{constructor(e,r,o,h,$,ee){this.route=e,this.router=r,this.eventService=o,this.authService=h,this.emotionService=$,this.themeService=ee,this.isLoading=!0,this.currentUser=null,this.newComment=""}ngOnInit(){this.currentUser=this.authService.getCurrentUser();let e=this.route.snapshot.paramMap.get("id");e&&(this.loadEvent(e),this.switchTheme(this.event?.emotion||""))}loadEvent(e){this.eventService.getEventById(e).subscribe({next:r=>{switch(this.event=r,this.isLoading=!1,this.event?.emotion){case"joy":this.themeService.setTheme("joy");break;case"sadness":this.themeService.setTheme("sadness");break}},error:r=>{console.error("Error loading event:",r),this.isLoading=!1}})}likeEvent(){this.event&&this.eventService.toggleLike(this.event.id).subscribe({next:e=>{console.log(e);let r=this.route.snapshot.paramMap.get("id");r&&(this.loadEvent(r),this.switchTheme(this.event?.emotion||""))},error:e=>{console.error("Error liking event:",e)}})}addComment(){!this.event||!this.currentUser||!this.newComment.trim()||this.eventService.addComment(this.event.id,this.currentUser.id,this.currentUser.username,this.newComment.trim()).subscribe({next:e=>{this.event=e,this.newComment="",this.eventService.getEventById(this.event.id).subscribe({next:r=>{this.event=r},error:r=>{console.error("Error refreshing event:",r)}})},error:e=>{console.error("Error adding comment:",e)}})}deleteEvent(){this.event&&confirm("Are you sure you want to delete this event? This action cannot be undone.")&&this.eventService.deleteEvent(this.event.id).subscribe({next:()=>{this.router.navigate(["/events"])},error:e=>{console.error("Error deleting event:",e)}})}scrollToComments(){document.getElementById("comments")?.scrollIntoView({behavior:"smooth"})}getEmotionDisplayName(e){return this.emotionService.getEmotionDisplayName(e)}getEmotionIcon(e){return this.emotionService.getEmotionIcon(e)}shareEvent(){let e=window.location.href;navigator.share?navigator.share({title:this.event?.title||"Event",text:this.event?.content||"Check out this event!",url:e}).catch(r=>{console.error("Error sharing:",r),this.copyToClipboard(e)}):this.copyToClipboard(e)}copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{let r=document.querySelector('button:has(span:contains("\u{1F517} Share"))');if(r){let o=r.innerHTML;r.innerHTML="<span>\u2713 Copied!</span>",setTimeout(()=>{r.innerHTML=o},2e3)}}).catch(r=>{console.error("Failed to copy text: ",r)})}switchTheme(e){switch(e){case"joy":_(b.INTENSITY);break;case"sadness":_(b.LIGHT_MELANCHOLY);break;case"anger":_(b.DARK_PASSION);break;default:break}}static{this.\u0275fac=function(r){return new(r||t)(u(O),u(H),u(X),u(J),u(Q),u(Z))}}static{this.\u0275cmp=w({type:t,selectors:[["app-event-detail"]],decls:12,vars:5,consts:[[1,"mx-auto","max-w-4xl"],[1,"mb-6","flex","items-center","justify-between"],["routerLink","/events",1,"flex","items-center","text-sm","font-medium","text-gray-600","hover:text-gray-900","dark:text-gray-400","dark:hover:text-gray-200"],[1,"mr-1"],[1,"flex","space-x-3"],["class","rounded-md bg-gray-100 px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-200 dark:hover:bg-gray-600",3,"routerLink",4,"ngIf"],["class","rounded-md bg-red-100 px-3 py-2 text-sm font-medium text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-200 dark:hover:bg-red-900/30",3,"click",4,"ngIf"],["class","flex justify-center py-12",4,"ngIf"],[3,"ngClass",4,"ngIf"],["class","rounded-lg bg-white p-8 text-center shadow-elevation-1 dark:bg-gray-800",4,"ngIf"],[1,"rounded-md","bg-gray-100","px-3","py-2","text-sm","font-medium","text-gray-700","hover:bg-gray-200","dark:bg-gray-700","dark:text-gray-200","dark:hover:bg-gray-600",3,"routerLink"],[1,"rounded-md","bg-red-100","px-3","py-2","text-sm","font-medium","text-red-700","hover:bg-red-200","dark:bg-red-900/20","dark:text-red-200","dark:hover:bg-red-900/30",3,"click"],[1,"flex","justify-center","py-12"],[1,"h-8","w-8","animate-spin","rounded-full","border-4","border-primary-500","border-t-transparent"],[3,"ngClass"],[1,"mb-6","rounded-lg","bg-white","p-6","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-gray-900","dark:text-white"],[1,"mt-2","flex","items-center","text-sm","text-gray-500","dark:text-gray-400"],[1,"mx-2"],[1,"prose","prose-lg","max-w-none","dark:prose-invert"],[1,"whitespace-pre-wrap","text-gray-700","dark:text-gray-300"],["class","mt-6",4,"ngIf"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-1","rounded-md","px-3","py-1","text-sm","text-gray-700","hover:bg-gray-100","dark:text-gray-300","dark:hover:bg-gray-700",3,"click"],[1,"rounded-md","px-3","py-1","text-sm","text-gray-700","hover:bg-gray-100","dark:text-gray-300","dark:hover:bg-gray-700",3,"click"],["id","comments",1,"rounded-lg","bg-white","p-6","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","text-xl","font-semibold","text-gray-900","dark:text-white"],["class","mb-6",4,"ngIf"],[1,"space-y-4"],["class","flex space-x-3",4,"ngFor","ngForOf"],["class","py-4 text-center",4,"ngIf"],[1,"mt-6"],[1,"mb-3","text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-2","gap-4","md:grid-cols-3"],["class","overflow-hidden rounded-lg",4,"ngFor","ngForOf"],[1,"overflow-hidden","rounded-lg"],["alt","Attachment",1,"h-48","w-full","object-cover","transition","duration-300","hover:scale-105",3,"src"],[1,"mb-6"],[1,"avatar"],["alt","Your profile image","class","h-full w-full object-cover",3,"src",4,"ngIf"],[4,"ngIf"],[1,"flex-1"],[3,"ngSubmit"],["name","comment","rows","3","placeholder","Write a comment...",1,"textarea",3,"ngModelChange","ngModel"],[1,"mt-2","flex","justify-end"],["type","submit",1,"rounded-md","bg-primary-600","px-3","py-1.5","text-sm","font-medium","text-white","hover:bg-primary-700","focus:outline-none","focus:ring-2","focus:ring-primary-500","focus:ring-offset-2","disabled:opacity-50","dark:bg-primary-700","dark:hover:bg-primary-600",3,"disabled"],["alt","Your profile image",1,"h-full","w-full","object-cover",3,"src"],[1,"flex-1","rounded-lg","bg-gray-50","p-4","dark:bg-gray-700"],[1,"mb-1","flex","items-center","justify-between"],[1,"text-sm","font-semibold","text-gray-900","dark:text-white"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"text-sm","text-gray-700","dark:text-gray-300"],[1,"py-4","text-center"],[1,"text-gray-500","dark:text-gray-400"],[1,"rounded-lg","bg-white","p-8","text-center","shadow-elevation-1","dark:bg-gray-800"],[1,"mb-4","text-4xl"],[1,"mb-2","text-xl","font-semibold","text-gray-900","dark:text-white"],[1,"mb-6","text-gray-600","dark:text-gray-400"],["routerLink","/events",1,"inline-block","rounded-md","bg-primary-600","px-4","py-2","text-white","hover:bg-primary-700","dark:bg-primary-700","dark:hover:bg-primary-600"]],template:function(r,o){r&1&&(n(0,"div",0)(1,"div",1)(2,"a",2)(3,"span",3),s(4,"\u2190"),i(),s(5," Back to Events "),i(),n(6,"div",4),v(7,ie,2,3,"a",5)(8,re,2,0,"button",6),i()(),v(9,oe,2,0,"div",7)(10,pe,41,21,"div",8)(11,ge,9,0,"div",9),i()),r&2&&(a(7),m("ngIf",o.currentUser&&(o.event==null?null:o.event.userId)===o.currentUser.id),a(),m("ngIf",o.currentUser&&(o.event==null?null:o.event.userId)===o.currentUser.id),a(),m("ngIf",o.isLoading),a(),m("ngIf",!o.isLoading&&o.event),a(),m("ngIf",!o.isLoading&&!o.event))},dependencies:[F,A,M,U,V,R,B,K,z,Y,G,q,W,P],encapsulation:2})}}return t})();export{De as EventDetailComponent};
