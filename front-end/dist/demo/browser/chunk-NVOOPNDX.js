import{a as U}from"./chunk-WPHHPEL3.js";import{A as p,Ia as g,a as i,b as c,h as a,l as u,u as l,x as h}from"./chunk-7K72UJZH.js";var j=(()=>{class o{constructor(e){this.http=e,this.apiUrl=`${U.apiUrl}/auth`,this.currentUserSubject=new a(null),this.currentUser$=this.currentUserSubject.asObservable();let t=localStorage.getItem("currentUser");t&&this.currentUserSubject.next(JSON.parse(t))}login(e,t){return console.log("Attempting login for:",e),this.http.post(`${this.apiUrl}/login`,{email:e,password:t}).pipe(l(r=>{console.log("Login response:",r);let n=c(i({},r.user),{token:r.token});localStorage.setItem("currentUser",JSON.stringify(n)),this.currentUserSubject.next(n)}),u(r=>r.user))}register(e,t,r){return console.log("Attempting registration for:",t),this.http.post(`${this.apiUrl}/register`,{name:e,email:t,password:r}).pipe(l(n=>{let s=c(i({},n.user),{token:n.token});console.log("Storing user with token:",s),localStorage.setItem("currentUser",JSON.stringify(s)),this.currentUserSubject.next(s)}),u(n=>n.user))}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null)}isAuthenticated(){return this.currentUserSubject.value!==null}getCurrentUser(){return this.currentUserSubject.value}static{this.\u0275fac=function(t){return new(t||o)(p(g))}}static{this.\u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();export{j as a};
