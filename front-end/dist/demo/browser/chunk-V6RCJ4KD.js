import{a as g}from"./chunk-WPHHPEL3.js";import{d as U}from"./chunk-55S3SV57.js";import{P as a,T as h,Y as p,a as o,b as u,m as l,t as c}from"./chunk-ZHZY3XIT.js";var j=(()=>{class n{constructor(s){this.http=s,this.apiUrl=`${g.apiUrl}/auth`,this.currentUserSubject=new l(null),this.currentUser$=this.currentUserSubject.asObservable();let t=localStorage.getItem("currentUser");t&&this.currentUserSubject.next(JSON.parse(t))}login(s,t){return this.http.post(`${this.apiUrl}/login`,{email:s,password:t}).pipe(a(e=>{console.log("Login response:",e);let r=u(o({},e.user),{token:e.token});localStorage.setItem("currentUser",JSON.stringify(r)),this.currentUserSubject.next(r)}),c(e=>e.user))}register(s,t,e){return this.http.post(`${this.apiUrl}/register`,{name:s,email:t,password:e}).pipe(a(r=>{let i=u(o({},r.user),{token:r.token});console.log("Storing user with token:",i),localStorage.setItem("currentUser",JSON.stringify(i)),this.currentUserSubject.next(i)}),c(r=>r.user))}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null)}isAuthenticated(){return this.currentUserSubject.value!==null}getCurrentUser(){return this.currentUserSubject.value}static{this.\u0275fac=function(t){return new(t||n)(p(U))}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{j as a};
