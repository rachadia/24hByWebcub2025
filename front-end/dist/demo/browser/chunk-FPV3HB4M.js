import{a as m}from"./chunk-WPHHPEL3.js";import{B as U,Ja as g,a as u,b as c,h,l as a,v as l,y as p}from"./chunk-7B2THDHR.js";var v=(()=>{class s{constructor(r){this.http=r,this.apiUrl=`${m.apiUrl}/auth`,this.currentUserSubject=new h(null),this.currentUser$=this.currentUserSubject.asObservable();let t=localStorage.getItem("currentUser");t&&this.currentUserSubject.next(JSON.parse(t))}login(r,t){return this.http.post(`${this.apiUrl}/login`,{email:r,password:t}).pipe(l(e=>{console.log("Login response:",e);let n=c(u({},e.user),{token:e.token});localStorage.setItem("currentUser",JSON.stringify(n)),this.currentUserSubject.next(n)}),a(e=>e.user))}register(r,t,e,n,S){return this.http.post(`${this.apiUrl}/register`,{first_name:r,last_name:t,username:e,email:n,password:S}).pipe(l(i=>{let o=c(u({},i.user),{token:i.token});console.log("Storing user with token:",o),localStorage.setItem("currentUser",JSON.stringify(o)),this.currentUserSubject.next(o)}),a(i=>i.user))}logout(){localStorage.removeItem("currentUser"),this.currentUserSubject.next(null)}isAuthenticated(){return this.currentUserSubject.value!==null}getCurrentUser(){return this.currentUserSubject.value}static{this.\u0275fac=function(t){return new(t||s)(U(g))}}static{this.\u0275prov=p({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();export{v as a};
